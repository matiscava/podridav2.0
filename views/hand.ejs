<%- include('./components/head.ejs') %> 
<main id="handMain">
  <div class="containerHand">
    <div class="spanContainer">
      <span class="problem opacity-0" id="problemSpan"></span>
    </div>
    <form action="/game/hand" method="post" class="formCards">
      <div class="handSlider">
        <div class="playerList">
          <p class="problem" id="problemText"></p>
          <% playerList.forEach( (p,index) => { %>
            <div class="formElement">
            <label class="labelName" for="[players][<%=index%>][predict]"<% if(index==6) { %> data-name="<%= p.name %>" <% } %> ><%=p.name %> pidió:</label>
            <div class="input-container">
              <% for (let i = 0; i<=cardLimit;i++) {%>
                <input type="radio" class="radioPredict none<% if(index===6) { %> lastPlayer<% } %>" name="[players][<%=index%>][predict]" id="predict-<%=p.id%>-<%=i%>" value="<%=i%>" <% if((p.predict && i==p.predict)|| i==0) { %> checked<% } %> >
                <label for="predict-<%=p.id%>-<%=i%>"><%=i%><%i===1 ? "carta" : "cartas" %></label>
                <% } %>  
            </div>
            <input type="hidden" name="[players][<%=index%>][playerId]" value="<%= p.id %>">
            <input type="hidden" name="[players][<%=index%>][handId]" value="<%= p.handId %>">
            </div>
          <% }) %>
          <input type="button" value="Jugar" id="btnPlay">
        </div>
        <div class="playerList">
          <% playerList.forEach( (p,index) => { %>
            <div class="formElement">
              <label class="labelName" for="[players][<%=index%>][take]"<% if(index==6) { %> data-name="<%= p.name %>" <% } %> ><%=p.name %> pidió <%= p.predict %>, cuantas se llevó:</label>
              <div class="input-container">
                <% for (let i = 0; i<=cardLimit;i++) {%>
                  <input type="radio" class="radioTake none" name="[players][<%=index%>][take]" id="take-<%=p.id%>-<%=i%>" value="<%=i%>" <% if(i==p.take) { %> checked<% } %> >
                  <label for="take-<%=p.id%>-<%=i%>"><%=i%><%i===1 ? "carta" : "cartas" %></label>
                <% } %>  
              </div>
              <input type="hidden" name="[players][<%=index%>][handId]" value="<%= p.handId %>">
            </div>
          <% }) %>
          <div class="formTakenButtons">
            <div class="inlineContainer">
              <div class="btnDiv disabled">
                <div id="btnPercentage"></div>
                <input id="input-submit" type="button" value="Calcular Puntos" disabled>
              </div>
            </div>
            <a href="/game/<%= gameId %>/addMistake" class="menu-button mistake-button">It's a Mistake</a>
            <input id="btnReturnTwo" class="menu-button" type="button" value="Editar pedidas">
          </div>
        </div>
        <div class="table-container">
          <table class="handPointsTable">
            <thead>
              <tr>
                <th scope="col">Jugador</th>
                <th scope="col">Pidió</th>
                <th scope="col">Se Llevó</th>
                <th scope="col">Puntos</th>
              </tr>
            </thead>
            <tbody>
              <% playerList.forEach( p => { %>
                <tr>
                  <th><%= p.name %></th>
                  <th><%= p.predict %></th>
                  <th><%= p.take %></th>
                  <th><%= p.points %></th>
                </tr>
              <% }) %>  
            </tbody>
          </table>
        </div>
      </div>

    </form>
  </div>
  </div>
</main>
<%- include('./components/footer.ejs')  %> 